{% extends "base.html" %}
{% block title %}CCTV ÏÉÅÏÑ∏ Î≥¥Í∏∞{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/view_cctv.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/chat.css') }}">
{% endblock %}

{% block content %}
<main class="content-area">
    <div class="cctv-container">
        <div class="cctv-header">
            <div class="cctv-title">
                <h1>üìπ {{ camera.location }} CCTV</h1>
                <div class="location-timestamp" id="current-time">Î°úÎî© Ï§ë...</div>
            </div>
            <div class="cctv-status">
                <span class="status-badge live">Ïã§ÏãúÍ∞Ñ</span>
                <span class="status-indicator"></span>
            </div>
        </div>
        
        <div class="cctv-main">
            <div class="cctv-stream-container">
                <div class="cctv-stream">
                    <img id="video-stream" src="http://{{camera.cctv_ip}}:5000/stream" alt="CCTV Stream">
                    <div class="stream-overlay">
                        <div class="overlay-top">
                            <span class="camera-id">Í∞ÄÎ°úÎì± Î≤àÌò∏: 2</span>
                            <span class="timestamp">{{ camera.location }}</span>
                        </div>
                    </div>
                </div>
                
                <div class="stream-controls">
                    <button class="control-btn fullscreen-btn" title="Ï†ÑÏ≤¥ ÌôîÎ©¥">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="control-btn snapshot-btn" title="Ïä§ÌÅ¨Î¶∞ÏÉ∑">
                        <i class="fas fa-camera"></i>
                    </button>
                </div>
            </div>
            
            <div class="cctv-sidebar">
                <div class="info-card">
                    <h2>CCTV Ï†ïÎ≥¥</h2>
                    <ul class="info-list">
                        <li><strong>ÏúÑÏπò:</strong> {{ camera.location }}</li>
                        <li><strong>Ïö©ÎèÑ:</strong> {{ camera.purpose }}</li>
                        <li><strong>ÏÑ§ÏπòÏùº:</strong> 2025-03-18</li>
                        <li><strong>Î™®Îç∏:</strong> ESP32-CAM</li>
                        <li><strong>IP Ï£ºÏÜå:</strong> {{ camera.cctv_ip }}</li>
                    </ul>
                </div>
                
                <div class="info-card sensor-data">
                    <h2>ÏÑºÏÑú Îç∞Ïù¥ÌÑ∞</h2>
                    <div class="sensor-status" id="safety-status">
                        <i class="fas fa-shield-alt"></i>
                        {% if camera.}
                    </div>
                    <div class="sensor-readings">
                        <div class="sensor-reading" id="temperature-reading">
                            <i class="fas fa-thermometer-half"></i>
                            <span>14¬∞C</span>
                        </div>
                        <div class="sensor-reading" id="humidity-reading">
                            <i class="fas fa-tint"></i>
                            <span>45%</span>
                        </div>
                        <div class="sensor-reading" id="heat-index-reading">
                            <i class="fas fa-temperature-high"></i>
                            <span>13¬∞C</span>
                        </div>
                    </div>
                </div>
                
                <div class="info-card">
                    <h2>Í∞ÄÎ°úÎì± ÏÉÅÌÉú</h2>
                    <div class="streetlight-status" id="streetlight-status">
                        <div class="status-icon on">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <span>Í∞ÄÎ°úÎì± ÏÉÅÌÉú: ÏñëÌò∏</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ï±ÑÌåÖ ÏúÑÏ†Ø Ï∂îÍ∞Ä -->
    {% include 'public/chat_widget.html' %}
</main>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/view_cctv.js') }}"></script>
<script src="{{ url_for('static', filename='js/chat.js') }}"></script>
{% endblock %}